curl -u elastic:p-RBd1cbdxY56_*JEBdF -X PUT "https://192.168.0.214:9200/rag2_dev_c7e1ba42-faf2-4929-b3c4-fb1e651f8f58_20240718-2" -H 'Content-Type: application/json' --insecure -d'
{
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 0
  }
}
'

curl -u elastic:p-RBd1cbdxY56_*JEBdF -X PUT "https://192.168.0.214:9200/_cluster/settings" -H 'Content-Type: application/json' --insecure -d'
{
  "persistent": {
    "cluster.max_shards_per_node": 5000
  }
}
'




curl -u elastic:p-RBd1cbdxY56_*JEBdF -X PUT "https://192.168.0.214:9200/rag2_dev_test" -H 'Content-Type: application/json' --insecure

{"error":{"root_cause":[{"type":"validation_exception","reason":"Validation Failed: 1: this action would add [2] shards, but this cluster currently has [1000]/[1000] maximum normal shards open;"}],"type":"validation_exception","reason":"Validation Failed: 1: this action would add [2] shards, but this cluster currently has [1000]/[1000] maximum normal shards open;"},"status":400}

curl -X PUT "localhost:9200/rag2_dev_c7e1ba42-faf2-4929-b3c4-fb1e651f8f58_20240718-2" -H 'Content-Type: application/json' -d'
{
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 0
  }
}
'

curl "http://localhost:49010/api/v1/rag/es/bulk_add" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag_test_dev22222222",
      "doc_list": [
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "7、作业人员必须站在阶梯凳上清除油污。阶梯凳表面垫干布，且有一人手扶阶梯凳。大分类中分类小分类活页号作业控制轧辊维护作业R1工作辊、R2支承辊拆装作业BASF-G-004-003-001-001-03编制人/日期 审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.08、拆装键块，取断螺丝必须在旋转装置上旋转至合适位置，旋转装置处于停止状态时才能作业。 9、作业前必须确认周围直径3m内无障碍物，离地50cm以上，二人以上作业，必须专人指挥。10、用卧式千斤顶需两人配合作业，手扶千斤顶外侧，确认安放正确后另一人开始加压，加压人员必须听从手扶千斤顶人员，严禁擅自加压千斤顶。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "作业控制轧辊维护作业F1-7精轧支承辊拆装作业BASF-G-004-003-001-002-01编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022. 03.011.0序号本岗位操作步骤（作业手顺）管理控制要求1 23[准备]1、选定钢丝绳、吊带，准备铜棒、扳手、撬棍、卸扣等。2、检查新辊辊径、辊面标识。 3、检查轴承箱衬板。4、检查轴承箱的连接油管、快速接头、各部件螺栓等。 [拆卸]1、使用专用吊具将轧辊吊至拆装台。（选用80T专用吊具）。2、卸横梁定位环螺栓，行车配合，拆下轧辊横梁（选用Φ11mm钢丝绳）。（仅适用于上辊）3、松门罩螺栓，用悬臂吊拆下支承辊箱体的门罩（选用Φ11mm钢丝绳）。 4、拆下扇形块固定螺栓的防松连接、扇形块固定螺栓和扇形块。5、使用高压油泵分别对锥套及液压螺母进行打压，直至锥套涨开、液压螺母松动。6、液压螺母完全旋松到位7、卸去液压螺母压力，同时操作支承辊拆装小车向外平移，带出轴承座。 8、行车配合，将旧辊吊至待磨区域。[组装]1、检查箱体各密封件是否完好。2、检查轴承箱各附件（F1B需测试负弯辊油缸）铜棒、撬棍、扳手使用时必须擦拭干净。按《技术规程》要求，辊面标识正确，无遗漏。无破损、无变形。 紧固、无变形。选择对应的平台底座；起吊前必须确认四个吊销全部进入轴承座规定孔内,且黄色的夹紧指示灯点亮。行车必须对正，防止横梁变形。保持液压螺母押入压PN=380Kg/cm2，使锥套内压PN=500 Kg/cm2 ，并保持2分钟。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "PC装置检查：铜滑块表面及开裆尺寸；PC装置加油并同步转动PC连杆；PC连杆摆角大于146度。大分类中分类小分类活页号作业控制轧辊维护作业F1-7精轧支承辊拆装作业BASF-G-004-003-001-002-02 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求3、用清洗剂清洗新辊颈和轧辊端面。 4、在轧辊端面、轴承座衬板涂油。5、行车配合，将新辊吊至组装台上。6、操作支承辊拆装小车，带动轴承座向内平移，使轴承座套上辊颈，到位。7、使用悬臂吊，套上专用夹具，装上液压锁紧装置，旋转到位。8、使用高压油泵，交替打压液压锁紧与锥套，打压锁紧到位,缓慢卸去锥套油压。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "传动侧、操作侧上压力板组件高度差<0.5mm；大分类中分类小分类活页号作业控制轧辊维护作业F1-7精轧支承辊拆装作业BASF-G-004-003-001-002-03编制人/日期审核人/日期批准人/日期 修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0三、可能产生的问题及后果 1、作业场地油污多，作业时容易打滑、摔到。2、拆装小车拆装轴承座时，下轴承座晃动容易翻倒伤人。 3、使用高压油泵，快速接头安装不到位，打压时接头或液压油易弹出或飞溅伤人。4、拆装轴承座罩盖，配合不当易伤手或砸到脚。5、拆装锁紧螺母，配合不当易伤手或砸到脚。6、拆装横梁定距环时，用力不当容易摔倒受伤。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "千斤顶压杆操作人员必须听从托顶缸人员的指令，确认后方可松千斤顶；顶缸垫块垂直方向3米内不得站人。12、轴承座及辊头垂直方向3米内不得站人。大分类中分类小分类活页号作业控制轧辊维护作业R2工作辊拆装作业BASF-G-004-003-001-003-01 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求123[准备]1、选定钢丝绳、吊带，准备铜棒、扳手、撬棍、卸扣等。 2、检查新辊辊径、辊面标识。 3、检查新辊扁头、轴承箱衬板、肩板、油缸顶块等相关部件。4、检查轴承箱的车轮、柱销等。[拆卸]1、行车配合，将上、下轧辊吊至粗轧工作辊拆装架（选用Φ34mm钢丝绳）。2、移除防水罩，卸去卡环螺母，半龙门吊配合，拆除卡环(选用Φ11mm钢丝绳)。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "紧固、无变形。衬板、肩板、顶紧缸垫块无杂质。加油至新油缢出为止。轧辊轻落轻放、保证平稳。均匀涂油。半龙门吊必须对正，防止轴承座与辊颈碰撞。垫片、弹簧垫和卡环螺帽安装在卡环螺栓上。加油至新油缢出为止。上下辊间距：116mm≤上下辊间距≤121mm，四点极差≤2. 5mm。大分类中分类小分类活页号作业控制轧辊维护作业R2工作辊拆装作业BASF-G-004-003-001-003-02编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022. 02.28庞宗宝/2022.03.011.0三、可能产生的问题及后果 1、R2工作辊上轴承座容易翻转伤人，造成安全事故。2、吊运作业钢丝绳易断裂造成设备损坏和人员伤亡事故。3、用钢丝绳吊物时易伤手或吊物砸到脚。",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "铜棒、撬棍、扳手等使用时必须擦拭干净。按《技术规程》要求，辊面标识正确，无遗漏。三根钢丝绳分别挂在行车的主、副钩上。罩盖落下方向轴向1.5m内严禁站人。脚不得立于待拆轴承座总成侧面0.5m内。半龙门吊必须对正，防止轴承座卡阻； 拉出的轴承箱放置平稳，无晃动。轧辊轻落轻放、保证平稳。无杂质、无油污。无破损、无变形、无开裂；车轮转动灵活。损坏的或到使用周期的按规定更换，并做好记录。紧固、无变形轧辊轻落轻放、保证平稳。均匀涂油。装入时径向1米内不得站人。 传动侧键块用螺栓固定。油封处新油缢出为止。各个润滑点都出油为止；分配阀及各管道连接部位无漏油。出水口畅通地吹出压缩空气，且无漏气。大分类中分类小分类活页号作业控制轧辊维护作业E1/E2立辊拆装作业BASF-G-004-003-001-004-02 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求    14、行车配合，立辊在空中翻转90度后吊至立辊摆放架（选用Φ34mm、Φ20mm钢丝绳）。 15、校正扁头位置。三根钢丝绳分别挂在行车的主、副钩上。扁头和上座两侧吊耳成垂直状态。三、可能产生的问题及后果 1、吊立辊翻转（空中）容易造成设备损坏和人身伤亡事故。2、校正立辊扁头时，作业人员易从辊架上摔下。 3、用钢丝绳吊物时易伤手或吊物砸到脚。4、拆卸立辊门罩时门罩易滑落伤人。5、打击作业，易造成作业人员伤害。6、地面油污较多，人易滑倒受伤。7、拆装轴承座时，轴承座易碰伤作业人员。四、操作过程应急反应要求",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "6、及时清除地面油污，并铺设防滑布。7、拆装轴承座时，作业人员不能站在轴承座轴向位置，并离开吊物1米以上。大分类中分类小分类活页号作业控制轧辊维护作业F1E立辊拆装作业BASF-G-004-003-001-005-01 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求1  23[准备]1、选定钢丝绳，准备铜棒、扳手、撬棍、卸扣、吊环等。 2、检查新辊辊径、辊面标识、扁头。 [拆卸]1、半龙门吊配合，将立辊吊至拆装区域（选用Φ11mm钢丝绳）。2、卸防水罩固定螺丝，取下防水罩。3、卸卡环螺母，取下卡环。4、半龙门吊配合，拉出上轴承座（选用Φ11mm钢丝绳），并放置在指定位置。",
            "source_type": "RAG_KB"
        }
    ]
    }' 

curl "http://localhost:49010/api/v1/rag/es/bulk_add" \
-H "Content-Type: application/json" \
-d '{
    "index_name": "rag2_dev_c7e1ba42-faf2-4929-b3c4-fb1e651f8f58_20240718-2",
    "doc_list": [
        {
            "title": "白龙马23.txt",
            "snippet": "白龙马 蹄朝西，驮着唐三藏跟着仨徒弟，西天取经上大路，一走就是几万里。什么妖魔鬼怪，什么美女画皮，什么刀山火海，什么陷阱诡计。什么妖魔鬼怪，什么美女画皮，什么刀山火海，什么陷阱诡计。",
            "source_type": "RAG_KB",
            "meta_data": {
                "file_name": "白龙马23.txt"
            }
        },
        {
            "title": "白龙马23.txt",
            "snippet": "什么妖魔鬼怪，什么美女画皮，什么刀山火海，什么陷阱诡计。都挡不住火眼金睛的如意棒，护送师徒朝西去，白龙马，蹄朝西。都挡不住火眼金睛的如意棒，护送师徒朝西去，白龙马，蹄朝西。",
            "source_type": "RAG_KB",
            "meta_data": {
                "file_name": "白龙马23.txt"
            }
        }
    ]
}
'

curl "http://localhost:49010/api/v1/rag/es/bulk_add" \
-H "Content-Type: application/json" \
-d '{
    "index_name": "rag2_dev_0624_docx测试",
    "doc_list": [
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "铜棒、撬棍、扳手等使用时必须擦拭干净。按《技术规程》要求，辊面标识正确，无遗漏。三根钢丝绳分别挂在行车的主、副钩上。罩盖落下方向轴向1.5m内严禁站人。脚不得立于待拆轴承座总成侧面0.5m内。半龙门吊必须对正，防止轴承座卡阻； 拉出的轴承箱放置平稳，无晃动。轧辊轻落轻放、保证平稳。无杂质、无油污。无破损、无变形、无开裂；车轮转动灵活。损坏的或到使用周期的按规定更换，并做好记录。紧固、无变形轧辊轻落轻放、保证平稳。均匀涂油。装入时径向1米内不得站人。 传动侧键块用螺栓固定。油封处新油缢出为止。各个润滑点都出油为止；分配阀及各管道连接部位无漏油。出水口畅通地吹出压缩空气，且无漏气。大分类中分类小分类活页号作业控制轧辊维护作业E1/E2立辊拆装作业BASF-G-004-003-001-004-02 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求    14、行车配合，立辊在空中翻转90度后吊至立辊摆放架（选用Φ34mm、Φ20mm钢丝绳）。 15、校正扁头位置。三根钢丝绳分别挂在行车的主、副钩上。扁头和上座两侧吊耳成垂直状态。三、可能产生的问题及后果 1、吊立辊翻转（空中）容易造成设备损坏和人身伤亡事故。2、校正立辊扁头时，作业人员易从辊架上摔下。 3、用钢丝绳吊物时易伤手或吊物砸到脚。4、拆卸立辊门罩时门罩易滑落伤人。5、打击作业，易造成作业人员伤害。6、地面油污较多，人易滑倒受伤。7、拆装轴承座时，轴承座易碰伤作业人员。四、操作过程应急反应要求",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "6、及时清除地面油污，并铺设防滑布。7、拆装轴承座时，作业人员不能站在轴承座轴向位置，并离开吊物1米以上。大分类中分类小分类活页号作业控制轧辊维护作业F1E立辊拆装作业BASF-G-004-003-001-005-01 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求1  23[准备]1、选定钢丝绳，准备铜棒、扳手、撬棍、卸扣、吊环等。 2、检查新辊辊径、辊面标识、扁头。 [拆卸]1、半龙门吊配合，将立辊吊至拆装区域（选用Φ11mm钢丝绳）。2、卸防水罩固定螺丝，取下防水罩。3、卸卡环螺母，取下卡环。4、半龙门吊配合，拉出上轴承座（选用Φ11mm钢丝绳），并放置在指定位置。",
            "source_type": "RAG_KB"
        }
    ]
}
'

curl "http://localhost:49010/api/v1/rag/es/bulk_add" \
-H "Content-Type: application/json" \
-d '{
    "index_name": "rag2_dev_0624_docx测试2",
    "doc_list": [
        {
            "title": "yunyingshang-lingdao-lx_20240522.txt",
            "snippet": "简勤，男，1966年3月生，研究生，经济学博士，中共党员。曾任江西移动党组书记、董事长、总经理，四川移动党组书记、董事长、总经理，广东移动党组书记、董事长、总经理，中国移动通信集团副总经理、党组成员，中国邮政集团有限公司董事、党组副书记。现任中国联合网络通信集团有限公司董事、总经理、党组副书记。现任中国联通总经理、党组副书记：简勤。中国联通总经理：简勤。联通总经理：简勤。陈忠岳，1971年6月生，大学本科，经济学硕士，中共党员。历任中国电信浙江分公司副总经理、党组成员，中国电信公众客户事业部总经理，中国电信山西分公司总经理、党组书记，中国电信集团有限公司副总经理、党组成员，中国联合网络通信集团有限公司董事、总经理、党组副书记。现任中国联合网络通信集团有限公司董事长、党组书记。现任中国联通董事长、党组书记：陈忠岳。中国联通董事长：陈忠岳。联通董事长：陈忠岳。王俊治，1964年11月生,研究生，工学硕士，中共党员。曾任：中华全国总工会劳动保护部副部长、部长，中国能源化学工会全国委员会主席、分党组书记，中华全国总工会劳动和经济工作部部长，中华全国总工会书记处书记、党组成员。中华全国总工会第十五届、十六届执行委员会委员，十六届主席团委员。",
            "source_type": "RAG_KB"
        }
    ]
}
'

curl "http://localhost:49010/api/v1/rag/es/search" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag2_dev_20240725_xiehe",
      "query": "Glasgow 酒精性肝炎评分",
      "top_k": 10,
      "min_score": 0,
    "search_by":"title"
    }' 


curl "http://localhost:49010/api/v1/rag/es/search" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag2_dev_20240725_xiehe",
      "query": "Glasgow 酒精性肝炎评分",
      "top_k": 10,
      "min_score": 0
    }' 




curl "http://localhost:49010/api/v1/rag/es/bulk_add" \
-H "Content-Type: application/json" \
-d '{
    "index_name": "RAG2_dev_731a5fee-0ab7-4431-b0d3-f6807fba5ae5-Unicom-KB-APP-2",
    "doc_list": [
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "铜棒、撬棍、扳手等使用时必须擦拭干净。按《技术规程》要求，辊面标识正确，无遗漏。三根钢丝绳分别挂在行车的主、副钩上。罩盖落下方向轴向1.5m内严禁站人。脚不得立于待拆轴承座总成侧面0.5m内。半龙门吊必须对正，防止轴承座卡阻； 拉出的轴承箱放置平稳，无晃动。轧辊轻落轻放、保证平稳。无杂质、无油污。无破损、无变形、无开裂；车轮转动灵活。损坏的或到使用周期的按规定更换，并做好记录。紧固、无变形轧辊轻落轻放、保证平稳。均匀涂油。装入时径向1米内不得站人。 传动侧键块用螺栓固定。油封处新油缢出为止。各个润滑点都出油为止；分配阀及各管道连接部位无漏油。出水口畅通地吹出压缩空气，且无漏气。大分类中分类小分类活页号作业控制轧辊维护作业E1/E2立辊拆装作业BASF-G-004-003-001-004-02 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求    14、行车配合，立辊在空中翻转90度后吊至立辊摆放架（选用Φ34mm、Φ20mm钢丝绳）。 15、校正扁头位置。三根钢丝绳分别挂在行车的主、副钩上。扁头和上座两侧吊耳成垂直状态。三、可能产生的问题及后果 1、吊立辊翻转（空中）容易造成设备损坏和人身伤亡事故。2、校正立辊扁头时，作业人员易从辊架上摔下。 3、用钢丝绳吊物时易伤手或吊物砸到脚。4、拆卸立辊门罩时门罩易滑落伤人。5、打击作业，易造成作业人员伤害。6、地面油污较多，人易滑倒受伤。7、拆装轴承座时，轴承座易碰伤作业人员。四、操作过程应急反应要求",
            "source_type": "RAG_KB"
        },
        {
            "title": "作业处理(1)(1).txt",
            "snippet": "6、及时清除地面油污，并铺设防滑布。7、拆装轴承座时，作业人员不能站在轴承座轴向位置，并离开吊物1米以上。大分类中分类小分类活页号作业控制轧辊维护作业F1E立辊拆装作业BASF-G-004-003-001-005-01 编制人/日期审核人/日期批准人/日期修改状态施敏杰/2022.02.25庄国荣/2022.02.28庞宗宝/2022.03.011.0序号本岗位操作步骤（作业手顺）管理控制要求1  23[准备]1、选定钢丝绳，准备铜棒、扳手、撬棍、卸扣、吊环等。 2、检查新辊辊径、辊面标识、扁头。 [拆卸]1、半龙门吊配合，将立辊吊至拆装区域（选用Φ11mm钢丝绳）。2、卸防水罩固定螺丝，取下防水罩。3、卸卡环螺母，取下卡环。4、半龙门吊配合，拉出上轴承座（选用Φ11mm钢丝绳），并放置在指定位置。",
            "source_type": "RAG_KB"
        }
    ]
}
'


curl "http://localhost:49010/api/v1/rag/es/search" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag_test_dev",
      "query": "在R2工作辊拆装作业中，在柱销注入润滑油时，需要加到什么程度?",
      "top_k": 10,
      "min_score": 1.5
    }' 

curl "http://localhost:49010/api/v1/rag/es/search" \
-H "Content-Type: application/json" \
-d '{
    "index_name": "ceshi_0525",
    "query": "联通董事长是谁"
}' 

curl "http://localhost:49010/api/v1/rag/es/fetch_all" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "731a5fee-0ab7-4431-b0d3-f6807fba5ae5-unicom_kb_app"
    }'



curl "http://localhost:49010/api/v1/rag/es/delete_doc" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "731a5fee-0ab7-4431-b0d3-f6807fba5ae5-unicom_kb_app",
      "title": "'special-20240512'"
    }' 


curl "http://localhost:49010/api/v1/rag/es/fetch_all" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag2_dev_20240725_xiehe"
    }'

curl "http://localhost:49010/api/v1/rag/es/delete_index" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "731a5fee-0ab7-4431-b0d3-f6807fba5ae5-unicom_kb_app"
    }'

curl "http://localhost:49010/api/v1/rag/es/delete_index" \
-H "Content-Type: application/json" \
-d '{
      "index_name": "rag_test"
    }' 
