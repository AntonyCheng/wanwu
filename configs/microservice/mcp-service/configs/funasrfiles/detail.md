# 医疗长音频转写 - 智能分段医疗会议转写服务

## 📋 服务信息

**服务名称**: 医疗长音频转写 - 智能分段医疗会议转写服务

**基于项目**: Paraformer (中科院语音所)

**简短描述**: 基于中科院语音所 Paraformer-large 模型的专业医疗长音频转写服务。专门针对医疗会议、会诊、学术讲座等长音频文件进行智能分段转写优化。支持异步处理、实时进度监控、批量转写和多格式导出。内置医疗会议专业词汇库，包含会议术语、科室名称、检查设备、药物分类、手术术语、症状体征等6大类专业词汇，自动进行医疗文本结构化增强。

**部署URL**: http://localhost:9099/sse

---

## 🚀 快速启动

### 安装依赖
```bash
pip install funasr librosa soundfile fastmcp
```

### 启动服务
```bash
python paraformer_long_medical_transcribe_mcp.py
```

### 运行测试
```bash
python test_paraformer_long_medical.py
```

---

## 🔧 Cursor MCP 配置

在 `.cursor/mcp_settings.json` 中添加：

```json
{
  "mcpServers": {
    "paraformer_long_medical": {
      "type": "sse",
      "url": "http://localhost:9099/sse",
      "timeout": 1800
    }
  }
}
```

---

## 🎯 核心功能

- **长音频智能分段转写**: 自动分割长音频，支持超大文件处理
- **批量医疗音频转写**: 同时处理多个音频文件，提升工作效率
- **实时进度监控**: 异步处理模式，实时查询转写进度和状态
- **多格式结果导出**: 支持JSON、文本、SRT、VTT四种导出格式
- **医疗会议文本增强**: 专业医疗术语自动纠错和结构化处理
- **音频智能分段分析**: 提供详细的音频分析和质量评估
- **任务状态管理**: 完整的任务生命周期管理和监控

---

## 💡 使用示例

```
@paraformer_long_medical 转写这个2小时的医疗会议录音
@paraformer_long_medical 批量处理这些MDT会议音频文件
@paraformer_long_medical 查询转写任务的进度状态
@paraformer_long_medical 导出转写结果为SRT字幕格式
@paraformer_long_medical 增强这段医疗会议文本的结构化
@paraformer_long_medical 分析这个长音频的分段情况
```

---

## 🏥 医疗会议专业词汇库

| 类别 | 描述 | 示例 |
|-----|------|------|
| 会议术语 | 医疗会议常用术语 | 病例讨论、多学科会诊、MDT |
| 科室名称 | 医院各科室部门 | 心内科、神经外科、ICU |
| 检查设备 | 医疗设备和检查项目 | CT、MRI、心电图、胃镜 |
| 药物分类 | 药物类型和分类 | 抗生素、降压药、麻醉药 |
| 手术术语 | 手术相关专业术语 | 手术适应症、术前准备、切除术 |
| 症状体征 | 临床症状和体征 | 发热、疼痛、呼吸困难 |

---

## 📊 技术特性

- **智能分段处理**: 自动分割长音频，默认30秒片段，2秒重叠
- **异步任务管理**: 后台处理，避免超时，支持大文件转写
- **实时进度监控**: 分段级别的进度跟踪，预估剩余时间
- **批量处理能力**: 支持多文件同时处理，提升效率
- **多格式导出**: JSON、Text、SRT字幕、VTT字幕四种格式
- **医疗专业优化**: 针对医疗会议场景的词汇增强和错误纠正
- **质量评估**: 音频质量分析和处理建议

---

## 🔧 工具函数

| 函数名 | 功能描述 |
|--------|----------|
| `long_medical_audio_transcribe` | 医疗长音频智能分段转写 |
| `batch_medical_transcribe` | 批量医疗音频转写 |
| `get_transcribe_progress` | 获取转写进度 |
| `export_transcription_result` | 导出转写结果 |
| `medical_meeting_enhance` | 医疗会议文本结构化增强 |
| `segment_audio_analysis` | 音频智能分段分析 |
| `get_service_status` | 获取服务状态 |

---

## 📁 分段配置

```python
MODEL_CONFIG = {
    "chunk_length": 30,      # 每个音频块的长度（秒）
    "overlap_length": 2,     # 音频块重叠长度（秒）
    "sample_rate": 16000,    # 采样率
    "device": "cuda"         # 处理设备
}
```

---

## 📋 导出格式支持

| 格式 | 描述 | 用途 |
|-----|------|------|
| JSON | 完整结构化数据 | 程序处理、数据分析 |
| Text | 纯文本转写结果 | 文档记录、简单查看 |
| SRT | 标准字幕格式 | 视频字幕、时间轴显示 |
| VTT | WebVTT字幕格式 | 网页播放、在线字幕 |

---

## ⚠️ 注意事项

1. 专为长音频优化，建议处理1分钟以上的音频文件
2. 异步处理模式避免超时，适合处理超大音频文件
3. 支持16kHz采样率，其他采样率会自动转换
4. GPU加速可显著提升处理速度
5. 分段重叠确保转写连续性，避免词语截断
6. 超时时间设置为1800秒，适合长时间处理

---

## 🎯 应用场景

- **医疗会议记录**: MDT会议、学术讨论自动转写
- **多学科会诊**: 跨科室会诊录音整理和归档
- **病例讨论**: 疑难病例讨论会议记录转写
- **学术讲座**: 医学培训、继续教育讲座转写
- **手术讨论**: 术前讨论、手术方案制定记录
- **临床教学**: 医学院教学录音转写和整理
- **远程医疗**: 远程会诊音频记录转写
- **质量管理**: 医疗质量讨论会议记录分析

---

## 🔄 处理流程

1. **音频分析**: 自动检测音频时长和格式
2. **智能分段**: 按配置长度分割音频，保证重叠
3. **异步转写**: 逐段转写，实时更新进度
4. **文本增强**: 医疗专业词汇纠错和优化
5. **结果合并**: 整合所有分段结果为完整文本
6. **格式导出**: 按需求导出不同格式的结果