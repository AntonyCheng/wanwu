# 多模态生理信号分析 - 脑电心电皮电综合分析服务

## 📋 服务信息

**服务名称**: 多模态生理信号分析 - 脑电心电皮电综合分析服务

**基于项目**: NeuroKit2

**简短描述**: 基于 NeuroKit2 的强大生理信号分析服务。支持 ECG(心电图)、EEG(脑电图)、EDA(皮肤电导)、EMG(肌电图)、RSP(呼吸信号)等多种生理信号格式，可进行心率变异性分析、脑电节律分析、皮肤电导反应检测、肌肉活动评估等。提供完整的信号预处理、特征提取、质量评估和测试信号生成功能，适用于神经科学研究、心理生理学实验、医疗监护等专业应用场景。

**部署URL**: http://localhost:8200/sse

---

## 🚀 快速启动

### 安装依赖
```bash
pip install neurokit2 numpy scipy fastmcp
```

### 启动服务
```bash
python neurokit2_mcp_sse.py
```

### 运行测试
```bash
python test_neurokit2_mcp_sse.py
```

---

## 🔧 Cursor MCP 配置

在 `.cursor/mcp_settings.json` 中添加：

```json
{
  "mcpServers": {
    "neurokit2_server": {
      "type": "sse",
      "url": "http://localhost:8200/sse",
      "timeout": 600
    }
  }
}
```

---

## 🎯 核心功能

- **ECG 心电分析**: 完整的心电图分析，R峰检测，心率变异性计算
- **EEG 脑电分析**: 脑电信号处理，频段功率分析，脑电节律评估
- **EDA 皮电分析**: 皮肤电导信号分析，SCR事件检测，情绪唤醒评估
- **多信号支持**: EMG肌电图、RSP呼吸信号等多模态生理信号处理
- **信号质量评估**: 智能信号质量检测，异常值处理，改进建议
- **测试信号生成**: 可配置参数的多类型模拟生理信号生成
- **高级特征提取**: 时域、频域、非线性特征的综合计算
- **实时信号处理**: 支持实时信号分析和批量数据处理

---

## 💡 使用示例

```
@neurokit2_server 分析这个ECG信号的心率变异性和R峰
@neurokit2_server 计算这个EEG信号各频段的功率分布
@neurokit2_server 检测这个EDA信号中的皮肤电导反应
@neurokit2_server 评估这个生理信号的质量如何
@neurokit2_server 生成一个心率70BPM的30秒ECG测试信号
@neurokit2_server 获取所有支持的生理信号类型列表
```

---

## 🧠 支持的生理信号类型

| 信号类型 | 描述 | 推荐采样率 | 主要特征 | 应用场景 |
|---------|------|-----------|----------|----------|
| **ECG** | 心电图-心脏电活动 | 250-1000Hz | R峰、心率、HRV指标 | 心率监测、心律不齐检测 |
| **EEG** | 脑电图-大脑电活动 | 250-1000Hz | 频段功率、脑电节律 | 睡眠分析、认知评估 |
| **EDA** | 皮肤电导-自主神经 | 4-128Hz | SCR峰值、电导水平 | 情绪识别、压力监测 |
| **EMG** | 肌电图-肌肉活动 | 1000-2000Hz | 肌肉激活、疲劳检测 | 运动分析、康复评估 |
| **RSP** | 呼吸信号-胸部运动 | 100-1000Hz | 呼吸频率、变异性 | 呼吸监护、睡眠研究 |

---

## 📊 技术特性

- **多模态支持**: 5种主要生理信号类型的专业分析
- **科学算法**: 基于NeuroKit2科学计算库，算法经过同行评议
- **完整流程**: 信号清理→特征提取→质量评估→结果输出
- **频域分析**: 功率谱密度、频段功率、频率特征计算
- **时域分析**: 统计特征、变异性指标、峰值检测
- **非线性分析**: 复杂性指标、动力学特征、混沌分析
- **自适应处理**: 根据信号类型自动选择最优处理参数

---

## 🔧 工具函数

| 函数名 | 功能描述 | 主要用途 |
|--------|----------|----------|
| `analyze_ecg` | 完整ECG分析和HRV计算 | 心电图全面分析 |
| `detect_ecg_peaks` | R峰检测和心率计算 | 心跳检测 |
| `analyze_eeg` | EEG信号分析和频谱计算 | 脑电图分析 |
| `eeg_power_bands` | 脑电频段功率分析 | 脑电节律评估 |
| `analyze_eda` | EDA信号分析和SCR检测 | 皮肤电导分析 |
| `list_supported_signals` | 获取支持的信号类型 | 功能查询 |
| `generate_test_signal` | 生成测试生理信号 | 测试和验证 |
| `signal_quality_check` | 信号质量评估 | 质量控制 |

---

## 🧪 脑电频段配置

```python
# 标准EEG频段
EEG_BANDS = {
    "Delta": [0.5, 4],    # 深度睡眠
    "Theta": [4, 8],      # 轻度睡眠、冥想 
    "Alpha": [8, 13],     # 放松、闭眼状态
    "Beta": [13, 30],     # 清醒、专注状态
    "Gamma": [30, 100]    # 高级认知功能
}
```

---

## 📈 分析输出指标

| 信号类型 | 主要输出指标 | 示例值 |
|---------|-------------|--------|
| **ECG** | BPM, SDNN, RMSSD, PNN50, LF/HF | 72 BPM, 45ms, 35ms |
| **EEG** | Delta/Theta/Alpha/Beta/Gamma功率 | Alpha: 25%, Beta: 30% |
| **EDA** | SCR计数, 电导水平, Tonic/Phasic | 3 SCR/min, 2.5 µS |
| **EMG** | 肌肉激活强度, 频率特征 | RMS: 0.15, MDF: 85Hz |
| **RSP** | 呼吸频率, 变异性, 振幅 | 15次/分, CV: 12% |

---

## ⚠️ 注意事项

1. **采样率要求**: 不同信号类型有不同的采样率要求，请参考推荐值
2. **信号长度**: ECG至少5秒，EEG至少10秒，EDA至少30秒
3. **数据质量**: 避免伪迹干扰，确保电极接触良好
4. **预处理**: 服务会自动进行信号清理和滤波处理
5. **内存限制**: 超长信号会被截断输出以节省内存
6. **专业解释**: 结果需要结合专业知识和临床背景解释

---

## 🎯 应用场景

- **神经科学研究**: 大脑功能研究、认知神经科学实验
- **心理生理学**: 情绪反应研究、压力评估、唤醒度测量
- **医疗监护**: 心率监测、睡眠监测、术中监护
- **运动科学**: 运动员生理状态监测、训练效果评估
- **人机交互**: 脑机接口、情感计算、生理反馈系统
- **临床诊断**: 心律不齐检测、癫痫诊断、自主神经评估
- **康复医学**: 康复进度监测、神经康复评估
- **睡眠研究**: 睡眠分期、睡眠质量评估、睡眠障碍诊断

---

## 🔬 技术原理

### ECG处理流程
1. **信号清理**: 带通滤波、基线漂移校正
2. **R峰检测**: Pan-Tompkins算法、自适应阈值
3. **HRV计算**: 时域指标、频域指标、非线性指标

### EEG处理流程
1. **预处理**: 滤波去噪、工频干扰消除
2. **频谱分析**: 快速傅里叶变换、功率谱密度
3. **频段提取**: Delta、Theta、Alpha、Beta、Gamma功率

### EDA处理流程
1. **成分分离**: Tonic慢变成分、Phasic快变成分
2. **SCR检测**: 皮肤电导反应峰值识别
3. **特征计算**: 反应幅度、反应频率、基线水平

---

## 📚 科学背景

- **ECG**: 心电图反映心脏电传导系统活动，HRV指标反映自主神经调节
- **EEG**: 脑电图反映神经元群体同步活动，不同频段对应不同脑功能状态
- **EDA**: 皮肤电导反映交感神经活动，是情绪唤醒的敏感指标
- **多模态**: 结合多种生理信号可获得更全面的生理状态评估

---

## 🏆 优势特点

- **专业算法库**: 基于经过同行评议的NeuroKit2科学计算库
- **标准化流程**: 遵循国际标准的生理信号处理规范
- **多信号融合**: 支持多模态生理信号的综合分析
- **实时处理**: 高效的算法实现，支持实时分析需求